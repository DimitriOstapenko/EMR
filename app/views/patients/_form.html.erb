<%= simple_form_for (@patient) do |f| %>
  <%= render 'shared/error_messages', object: f.object %>
<!-- Row 1 -->
<div class="row">
  <div class="col-sm-3">
     <%= f.input :lname, hint: 'Required'%>
  </div>

  <div class="col-sm-3">
  <%= f.input :fname %>
  </div>

  <div class="col-sm-2">
  <%= f.input :mname, label: 'Middle Name' %>
  </div>

  <div class="col-sm-2">
  <%= f.input :sex, collection: SEXES, hint: 'Required', label: 'Gender', include_blank: false %>
  </div>
  
  <div class="col-sm-2">
	  <%= f.input :pat_type, collection: PATIENT_TYPES, hint: 'Required', label: 'Type', include_blank: false,
	      label_html: { "data-toggle": 'tooltip', class: "has-tip", 
              title: "HCP: OHIP covered;\n RMB: Out of Province;\n CSH: Cash; \n DEC: Deceased"}
  %>
  </div>
</div>

<!-- Row 2 -->
<div class="row">
  <div class="col-sm-3" id="maiden_name">
  <%= f.input :maid_name %>
  </div>
  
  <div class="col-sm-3" id="ifh_number", style="display:none;">
  <%= f.input :ifh_number, label:'IFH Number', hint: 'Required' %>
  </div>
</div>

<div class="row">
  <div class="col-sm-3">
  <%= f.input :ohip_num, label: 'Health Card Number', hint: 'Required *' %>
  </div>

  <div class="col-sm-1 padding-0">
     <%= f.input :ohip_ver, label: 'VC' %>
  </div>

  <div class="col-sm-1">
  <%= f.input :hin_prov, collection: PROVINCES, label: 'Prov.', include_blank: false %>
  </div>
  
  <div class="col-sm-3">
     <%= f.input :hin_expiry, start_year: Date.today.year, end_year: Date.today.year+5, html5: true, label: "Expires On", hint: 'Required *' %>
  </div>
  
  <div class="col-sm-3">
  <%= f.input :dob, as: :date, start_year: 1900, end_year: Date.today.year, hint: 'Required', html5: true %>
  </div>
  
  <div class="col-sm-1">
	  <%= f.input :clinic_pat, label: 'Clinic Patient' %>
  </div>

</div>
  
<!-- Row 3 -->
<div class="row">

  <div class="col-sm-4">
  <%= f.input :addr, label: 'Srteet Address' %>
  </div>
  
  <div class="col-sm-2">
  <%= f.input :city %>
  </div>
  
  <div class="col-sm-2">
  <%= f.input :prov, collection: PROVINCES, include_blank: false %>
  </div>
  
  <div class="col-sm-2">
	  <%= f.input :country, collection: ['Canada','US','Other'], selected: "Canada" %>
  </div>

  <div class="col-sm-2">
  <%= f.input :postal %>
  </div>
</div>

<!-- Row 4 -->

<div class="row">
  <div class="col-sm-3">
  <%# f.input :family_dr, label: 'Family Doctor' #%>
  <%= f.input :family_dr, collection: Doctor.all, label_method: :lname, value_method: :lname, prompt: 'Select' %>
  </div>
  
  <div class="col-sm-3">
  <%= f.input :phone, as: :tel,  value: num_to_phone(@patient.phone)  %>
  </div>
  
  <div class="col-sm-3">
  <%= f.input :mobile, as: :tel, value: num_to_phone(@patient.mobile) %>
  </div>
  
  <div class="col-sm-3">
  <%= f.input :email %>
  </div>
</div>

<!-- Row 5 -->
<div class="row">
  <div class="col-sm-3">
  <%= f.input :pharmacy %>
  </div>
  
  <div class="col-sm-3">
  <%= f.input :pharm_phone, as: :tel, label: 'Pharmacy Phone', value: num_to_phone(@patient.pharm_phone) %>
  </div>
  
  <div class="col-sm-3">
  <%= f.input :alt_contact_name, label: 'Emergency Contact' %>
  </div>

  <div class="col-sm-3">
  <%= f.input :alt_contact_phone, as: :tel, label: 'Contact phone' %>
  </div>
</div>
  
<!-- Row 6 -->  
<div class="row">
  <div class="col-sm-12">
  <%= f.input :allergies,  placeholder: 'Allergies', label: false  %>
  </div>
</div>

<!-- Row 7 -->
<div class="row">
  <div class="col-sm-12">
  <%= f.input :medications, as: :text, rows:2, placeholder: 'Medications', label: false %>
  </div>
</div>

<!-- Row 8 -->
<div class="row">
  <div class="col-sm-12">
  <%= f.input :notes, rows:4, placeholder: 'Patient Notes', label: false %>
  </div>
</div>

<div class="row">
  <div class="col-sm-12">
  <%= f.button :submit, "Save Patient's record", class: "btn btn-primary" %>
  </div>
</div>

<% end %>

<script>
$('body').tooltip({ selector: "[data-toggle~='tooltip']"});
$(document).ready(function () {
// Show maiden name text field for female patients 
   var sex = $('select[name="patient[sex]"]');
	
   (sex.val() =='F') ? $('#maiden_name').show() : $('#maiden_name').hide();
   sex.change(function () {
     (sex.val() =='F') ? $('#maiden_name').show() : $('#maiden_name').hide();
   });

// Show IFH number text field for IFH patients
   var pat_type = $('select[name="patient[pat_type]"]');	
	
   (pat_type.val() == 'I') ? $('#ifh_number').show() : $('#ifh_number').hide();
   pat_type.change(function () {
     (pat_type.val() == 'I') ? $('#ifh_number').show() : $('#ifh_number').hide();
   });
	
   var pmt_opt = document.getElementById('patient_pat_type').getElementsByTagName("option");
   var hin_prov = $('select[name="patient[hin_prov]"]');	     
   hin_prov.change(function () {
     if (hin_prov.val() == 'ON') {
        $(pat_type).val('O');
	pmt_opt[0].disabled = false;
	pmt_opt[1].disabled = true;
     } else {
        $(pat_type).val('R');
	pmt_opt[0].disabled = true;
	pmt_opt[1].disabled = false;
     }

   });
   	
});
</script>

