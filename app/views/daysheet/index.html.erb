<div id='result'></div>

<% date = params[:date].to_date rescue Date.today %>
<% provide(:title, "Day Sheet for " + date.to_s  ) %>
<% provide(:button_text, 'Save changes') %>
<%= render "shared/modal" %>

<div id='page'>
<table class="tbl table-hover" >
  <thead>
      <tr>
	  <th class="tbl_xs"></th>
	  <th class="tbl_sm"><%= sortable 'entry_ts', 'Time' %></th>
	  <% if date.today? %>
	  <th class="tbl_sm">Room</th>
 	  <% end %>
	  <th class="tbl_lsm">
	  <% if @docs.present? && @docs.size > 1 %>
          <span class="dropdown" >
            <a href="#" class="dropdown-toggle" data-toggle="dropdown"><font color="white"> Doctor <b class="caret"></b></font> </a>
            <ul class="dropdown-menu">
              <li><%= link_to "All", params.permit(:date).merge(date: params[:date]) %></li>
              <% @docs.each do | doc | %>
		<li><%= link_to doc.lname, params.permit(:doc_id,:date).merge(doc_id: doc.id, date: params[:date]) %> </li>
              <% end %>
            </ul>
          </span>
	  <% else %>
		Doctor  
	  <% end %>	
          </th>

	  <th class="tbl_lmd">Patient</th>
          <th class="tbl_sm">Type</th>
	  <% if device_is_desktop? %>
          <th class="tbl_md">HC/IFH #</th>
	  <% end %>
          <th class="tbl_lsm">Diag.</th>
          <th class="tbl_md">Services</th>
	  <% if device_is_desktop? %>
          <th class="tbl_md">Status</th>
	  <% end %>
	  <th class="tbl_sm"></th> 
	  <th class="tbl_sm"></th> 
	  <th class="tbl_sm"></th> 
	  <% if !device_is_desktop? %>
            <th class="tbl_sm"></th>
          <% end %>
	  <% if current_user.admin? %>
	    <th class="tbl_sm"></th>  <!-- Delete -->
  	  <% end %>

      </tr>
  </thead>
  <tbody>

  <% @daysheet.each do |v| %>
     <%= render 'visit', visit: v %>
  <% end %>

  </tbody>
</table>

<% if @daysheet.any? %>
<div class="bottom_nav">
<%= will_paginate @daysheet, class: "btn" %> 
</div>
<% end %>

</div>
