<html>
<!--
<form>

	Name: <input type="text" name="name" id="name">
	CCnum: <input type="text" name="ccnum" id="name">
	#exp: <input type="text" name="expiry" id="name">

</form>
-->

<head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap-theme.min.css">
    <script src="https://netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
    <script>
        $(document).ready(function () {
            try {
                window.external.KioskSimpleAPIInit();
                KioskSimple.Plugins.GetPlugin('Bank').OnCardSwiped = OnCardSwiped;
                KioskSimple.Plugins.GetPlugin('_devices').EnableAllDevicesByCategory("CreditCard");
                $(window).unload(function () {
                    KioskSimple.Plugins.GetPlugin('_devices').DisableAllDevicesByCategory("CreditCard");
                });
            }
            catch (err) {
                $("#output").append("Something went wrong intitializing KioskSimple. Error:" + err)
                return;
            }         
        });

        function OnCardSwiped(data, plugin, device) {
            var isIE = true;

            // Try using IE
            try {
                var ccdata = $.parseJSON(data);
                $("#name").val(ccdata.Name);
                $("#ccnum").val(ccdata.CardNumber);
                $("#expiry").val(ccdata.Expiration);
            } catch (err) {
                isIE = false;
            }

            // Else use Chrome
            if (!isIE) {
                try {
                    $("#name").val(data.Name);
                    $("#ccnum").val(data.CardNumber);
                    $("#expiry").val(data.Expiration);
                } catch (err) { $("#output").append(err); }
            }
        }
    </script>
</head>
<body>
    <div style="padding-top:30px;" class="container theme-showcase">
        <form class="form-horizontal" role="form">
            <div class="form-group">
                <label class="control-label col-sm-2" for="name">Name:</label>
                <div class="col-sm-10">
                    <input type="email" class="form-control" id="name" placeholder="Enter email">
                </div>
            </div>
            <div class="form-group">
                <label class="control-label col-sm-2" for="ccnum">Credit Card Number:</label>
                <div class="col-sm-10">
                    <input  class="form-control" id="ccnum" placeholder="Enter password">
                </div>
            </div>
            <div class="form-group">
                <label class="control-label col-sm-2" for="expiry">Expiration Date:</label>
                <div class="col-sm-10">
                    <input  class="form-control" id="expiry" placeholder="Expiration Date">
                </div>
            </div>           
        </form>
      
        <div class="row">
            <div class="col-sm-12">
                <div id="output" class="list-group" style="color:red;">
                </div>
            </div>
        </div>
    </div>
</body>
</html>
